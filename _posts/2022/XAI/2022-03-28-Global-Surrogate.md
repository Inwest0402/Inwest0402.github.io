---
title:  "[XAI] 글로벌 대리분석(Global Surrogate Analysis)"
excerpt: "글로벌 대리 분석이란 전체 학습 데이터를 상영해 블랙박스 함수 $f$를 따라하는 유사함수 $g$를만들고 $g$를 해석 가능하도록 변조하는 방법입니다."

categories:
  - Explainable-AI
tags:
  - [Machine Learning, XAI,Global Surrogate Analysis ]

toc: true
toc_sticky: true
use_math: true

# date: 2022-03-29
# last_modified_at: 2022-03-29
---
<!-- # Global Surrogate -->

글로벌 대리 분석이란 전체 학습 데이터를 상영해 블랙박스 함수 $f$를 따라하는 유사함수 $g$를만들고 $g$를 해석 가능하도록 변조하는 방법입니다.

글로벌 대리 분석 수행과정

1. 데이터 집합 $X$를 선택힙니다(학습데이터의 전부일 수도 있고, 일부일 수도 있습니다)
2. 선택한 데이터 집합 $X$에 대해 블랙박스 모델 $f의$ 예측 결과를 구합니다
3. XAI 모델을 고른다(선형회귀, 로지스틱 회귀, 의사 결정 트리, 나이브 베이즈, k-최근접 이웃 ). 학습한 결과를 모델 g라고 부릅니다
4. 모델 $g$는 설명 가능해야 합니다
5. 데이터 집합 $X$로 모델 $g$를 학습시킵니다
6. 데이터 $X$에 대해 모델 $f$가 예측한 결과와 모델 $g$의 예측 결과를 비교하면서 두 모델이 최대한 유사한 결과를 내도록 튜닝합니다
    
    e.g., R-squared방식
    
    $$
    R^2=1-\frac{SSE}{SST}=1-\frac{\sum_{i=1}^n(\hat{y}_*^{(i)}-\hat{y}^{(i)})^2}{\sum_{i=1}^n(\hat{y}^{(i)}-\hat{y})^2}
    $$
    
    여기서, $\hat{y}_*^{(i)}$는 모델 $g$가 예측한 i번째 데이터의 결과이고, $\hat{y}^{(i)}$는 모델 $f$가 예측한 i 번째 데이터의 결과이며, $\hat{y}$는 모델$f$의 예측 평균값입니다.
    
    R-스퀘어 결정지수가 1에 가깝다면 모델 $g$가 모델 $f$를 설명하는 데 합리적입니다.
    
    반대로 결정지가가 0에 가깝다면 모델$g$는 모델 $f$를 제대로 흉내 내지 못하므로 설명 가능한 인공지능을 만들어도 $f$를 제대로 해것하고 있다고 말하기 어렵습니다.
    
7. 위의 과정이 끝나면 설명 가능한 모델 $g$를 XAI 기법을 사용해 해석합니다

글로벌 대리 분석의 장점:

1. 유연성 - 다양한 XAI기법을 자우롭게 적용할 수 있을 뿐만 아니라 블랙박스 모델을 이해하고 있지 않아도 메저 함수(measure function, R-squared 결정 계수와 같은)를 가지고 모델 $f$가 어떻게 어떻게 학습되었는지 설명할 수 있습니다.
2. 직관적 - 대리 분석에 사용하는 머신러닝 기법은 구현이 쉽고 설명이 간단하다. 원래 모델을 유사하게 따라하는 대리 모형을 찾을 수만 있다면 큰 힘을 들이지 않고도 블랙박스 모델을 해석할 수 있습니다.

글로벌 대리 분석의 주의할 점:

1. 모델 $g$는 모델 $f$를 유사하게 설명하는 모델이며, 간접적으로 설명하기 때문에 $g$모델의 정확도와 $g$모델의 해석 방향에 결함이 있을 수 있습니다.
2. 메저 함수의 설명 가능성 판단 기준이 주관적이입니다.

    ***과연 수치가 얼마나 나와야 잘 나왔다고 판단할 수 있을까?***
    
    즉, 글로벌 대리 분석 기법으로 XAI를 수행할 때는 메저 함수와 모델 유사도에 따라 XAI에대한 신뢰도가 주관적임을 인지해야 합니다
    
3. 글로벌 대리 분석 모델이 학습하는 데이터 $X$가 편향되었을 위험이 있스빈다