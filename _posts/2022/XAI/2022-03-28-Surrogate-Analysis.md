---
title:  "[XAI] 대리분석(Surrogate Analysis)"
# excerpt: "분류와 회귀 작업 그리도 다중 출력 또한 가능한 의사결정나무"

categories:
  - Xai
tags:
  - [Machine Learning, XAI,Surrogate Analysis ]

# toc: true
# toc_sticky: true
use_math: true

# date: 2022-03-29
# last_modified_at: 2022-03-29
---
<!-- # Surrogate Analysis -->

대리분석이란 본래 기능을 흉내 내는 간단한 대체제를 만들어서 프로토타입이 동작하는지 판단하는 분석방법입니다.

XAI에서 대리분석은 본래 인공지능 모델이 너무 복잡해서 분석이 불가능할 때 유사한 기능을 흉내 내는 인공지능 모델 여러 개를 대리로 만들어서 본래 모델을 분석하는 기법을 말합니다.

~~(사실 이 분석 기법을 보면서 심리학과 많이 비슷하다고 느꼈습닌다. 일단 심리학에서도 어떻게 보면 보이지 않은 복잡한 사람의 마음을 최대한 가능한 방식으로 비슷한 모델을 만드는 것이기 때문입니다. )~~

분석을 해야하는 모델을 $f$라고하면, 대리 분석 모델은 $f$를 흉내내는 모델 $g$를 만드는 것입니다. 

여기서, 이 두 모델의 학습 방식은 같을 수도 또는 다를 수도 있다. 예를 들어, 모델 $f$가 심층신경망을 사용해 학습했다면, $g$는 트리나 선형 회귀 모델이 될 수 있습니다.

모델 $g$를 결정하는 조건은 아래와 같습니다.

(1) 모델 $f$ 보다 학습하기 쉽고

(2) 설명가능하며

(3) 모델 f를 유사하게 흉내 낼 수 있다

모델 $g$를 학습시키는 과정은 두 가지입니다.

(1) 모델 $f$를 학습시킬 때처럼 학습 데이터 전부를 모델 g를 학습하는 데 사용

(2) 학습 데이터의 일부만 추려서 모델 $g$를 학습시키는 것

이렇게 학습이 끝나면 모델 $g$는 조금이나마 $f$를 따라할 수 있게됩니다.

그리고 $g$는 설명가능하기 때문에 간단하게라도 $f$가 어떻게 학습되었는지 알 수 있습니다. 

즉, 모델 $g$는 모델 $f$보다 정확도가 떨어지지만, 모델 f를 대변할 수 있습니다.

대리분석를 설명 대상 범위로 분류하면, 글로벌 대리분석과 로컬 대리분석이 있습니다.

전자같은 경우는 학습 데이터(일부 또는 전부)를 사용해서 대리 분석 모델을 구축하는 과정이고, 후자는 모델이 학습 데이터 하나를 해석하는 과정입니다.

대리분석의 가장 큰 장점

모델 애그노스틱(*model-agnostic*, 즉 모델에 대한 지식이 없어도 학습할 수 있습니다)